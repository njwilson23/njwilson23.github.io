<html>
  <head>
    <meta charset="utf-8">
    <title>Where is Nat?</title>
    <script src="https://d3js.org/d3.v4.min.js"></script>
  </head>
  <body>

    <style type="text/css">
      #completed {
        background-color: steelblue;
      }
      #remaining {
        background-color: firebrick;
        opacity: 0.8;
      }
      div.bar {
        width: auto;
        height: auto;
        overflow: hidden;
      }
      div.barComponent {
        height: 5em;
        float: left;
      }
      body {
        margin-left: auto;
        margin-right: auto;
        width: 90%;
        font-family: Helvetica, Arial, sans;
      }
    </style>

    <h1>Trip completion</h1>

    <div class="bar">
      <div class="barComponent" id="completed"></div>
      <div class="barComponent" id="remaining"></div>
    </div>
    <div style="float: clear;"></div>

    <h1>Location</h1>
    <p><a href="http://www.sailwx.info/shiptrack/shipposition.phtml?call=DBLK">Polarstern location tracker</a></p>

    <script>

      function update() {
        var startTime = new Date(2016, 6, 8, 14),
            endTime = new Date(2016, 8, 9, 20);

        var totalMilliseconds = endTime - startTime;

        d3.select("#completed").style("width",
            function() { return Math.min(100, Math.max(0, (new Date()-startTime) / totalMilliseconds * 100)) + "%" });

        d3.select("#remaining").style("width",
            function() { return Math.min(100, Math.max(0, (endTime-new Date()) / totalMilliseconds * 100)) + "%" });
      }
      update();
      setInterval(update, 5000)

    </script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-47441592-3', 'auto');
      ga('send', 'pageview');

    </script>
  </body>
</html>
